# FAQ

### 文件存储的使用有哪些限制吗？
文件存储对文件系统容量、文件最大长度、协议版本等方面有一定限制，请您参考『产品限制』章节获取详细信息。

### 文件存储是否允许跨地域访问？
|产品类型   |是否支持跨地域访问   |支持方式  |
|--------|--------|--------|
|容量型	|否	|暂无|
|性能型	|是	|UDPN打通|

由于目前在容量型和性能型的网络接入方式上的差异，两类产品对跨地域访问表现略有区别。容量型产品不允许跨地域访问。性能型产品的网络是基于 VPC 的，在 UFS 控制台上您可以指定在文件系统实例所在同地域的多个 VPC 下的主机访问。如果需要在其他地域访问文件系统，您可以通过 UDPN 服务将需要访问文件系统的主机所在 VPC 和该文件系统挂载点所在的 VPC 打通即可。我们强烈建议您让文件系统和使用文件系统的主机位于同一地域，UDPN 服务可能会收取额外的费用并带来比同地域访问更高的延迟。

注：我们正在统一两类产品在网络接入方式上的差异，敬请期待。

### 文件存储是否允许跨项目组访问？
|产品类型   |是否支持跨地域访问   |支持方式  |
|--------|--------|--------|
|容量型	|否	|暂无|
|性能型	|是	|VPC 打通|

由于目前在容量型和性能型的网络接入方式上的差异，两类产品对跨项目组的访问表现略有区别。容量型产品不允许跨项目组访问。由于性能型产品的网络是基于 VPC 的，在 UFS 控制台上允许用户指定在文件系统实例所在项目组下的多个 VPC 下的主机访问，不在该项目组下的 VPC 默认不允许被创建挂载点。您可以通过在 VPC 页面上打通需访问文件系统的主机所在项目组和该文件系统挂载点所在项目组各自对应的 VPC 即可。

注：我们正在统一两类产品在网络接入方式上的差异，敬请期待。

### Linux NFS 客户端内核缺陷
由于文件存储服务依赖 NFS 客户端的服务，而 NFS 客户端在 Linux 上的实现存在一些缺陷，可能会导致 IO 卡住无响应等严重问题。

|发行版  |推荐系统版本  |推荐内核  |
|--------|--------|--------|
|CentOS	|7.6	|3.10.0-957.5.1.el7(请注意小版本5.1，低于此版本不建议使用)|
|Ubuntu	|18.04	|4.15|
|Debian	|10.0	|4.19|

我们强烈建议您将主机升级到上述推荐的内核版本，若无法升级导致遇到操作无响应的场景，需要通过重启主机进行恢复。

### 单个文件系统允许访问的主机客户端数量是否受限？
客户端主机通过文件系统对应的挂载点进行访问，由于挂载点限制的是允许访问的 VPC 而不是具体主机 IP，只要您合理规划 VPC 内各子网大小，VPC 内任意数量的主机都允许访问。虽然我们对挂载点的数目有一定的限制(详细请参考『产品限制』章节)，但对挂载点允许访问的主机数目是不限的。

### 物理云和托管云主机可以访问文件存储吗？

|   |物理云主机|托管云主机|
|--------|--------|--------|
|容量型	|支持	|不支持|
|性能型	|支持	|支持|

物理云主机可以通过在文件存储控制台上选择其所在 VPC，建立挂载点即可让主机访问文件存储。但托管云 VPC 默认不允许在文件存储控制台上进行打通，需要您联系托管云技术支持对托管云主机所在 VPC 和文件系统挂载点所在 VPC 进行互通操作后才能访问。

### Windows 系统挂载后无法写入数据、创建目录？
首先请在 Windows 终端(cmd) 执行 mount 命令查看当前挂载的文件系统具体挂载参数，若发现 UID、GID=-2(如下图)，正确的UID、GID 值应该为 0，该值不正确导致服务端因为权限校验失败拒绝请求。您需要按照如下步骤修改注册表信息：

#### 步骤一、找到注册表项
打开注册表找到：KEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\ClientForNFS\\CurrentVersion\\Default

![](/images/image_faq1.png)

#### 步骤二、新建 AnonymousUid、AnonymousGid

![](/images/image_faq2.png)

#### 步骤三、重启主机并重新挂载文件系统
挂在完成后在终端 (cmd) 中执行 mount 命令检查 UID、GID的值，如果均为 0 则正常。

![](/images/image_faq3.png)

### 如何修改 NFS 请求并发数(NFS 性能不足)?
NFS 客户端会对同时允许发起的请求个数进行限制，在众多发行版内核中该默认值通常为 2，由于并发较低会导致客户端能够达到的吞吐较低。为此，单客户端为了提升性能建议修改此参数。

#### 步骤一、安装 NFS 客户端
安装 NFS 客户端的详细步骤请参考 『操作指南』章节中的『挂载文件系统』部分。

#### 步骤二、修改系统参数
以 root 权限在命令行执行以下命令(该操作只需在首次安装 NFS 客户端完成后执行一次即可，后续不需多次执行)：

    echo "options sunrpc tcp_slot_table_entries=128" >> /etc/modprobe.d/sunrpc.conf

    echo "options sunrpc tcp_max_slot_table_entries=128" >> /etc/modprobe.d/sunrpc.conf

#### 步骤三、挂载文件系统
挂载文件系统的详细步骤请参考 『操作指南』章节中的『挂载文件系统』部分。

#### 步骤四、再次修改系统参数
通过执行以下命令修改相关系统参数：

    sysctl -w sunrpc.tcp_slot_table_entries=128

完成后卸载文件系统并重新挂载，之后执行如下命令查看系统参数值，如果返回值为 128 则表示设置成功。

    cat /proc/sys/sunrpc/tcp_slot_table_entries

### 文件存储的存储类型(容量型、性能型)可以修改吗？
不可以，目前还不支持将已创建的文件存储类型进行修改，如果您有类似需求可以通过创建新的文件系统实例，将老文件系统实例中的数据进行迁移。

### 文件系统删除前需要做特殊操作吗？
是的，在文件系统被删除前，请首先确保该文件系统内数据不会再被使用，目前文件存储不提供数据恢复功能，删除操作请谨慎。在您删除文件系统前请确保所有使用该文件系统的主机上都对其做了卸载操作，否则在主机上残留的已删除文件系统实例会影响主机运行。

### 文件存储不同类型存储的访问协议会统一吗？
是的，后续我们会将容量型和性能型存储的访问协议从 NFSv3 和 NFSv4 两种统一为 NFSv4，以降低产品使用差异导致的复杂度。并且针对 Windows 平台的 SMB 协议支持也在研发中。

